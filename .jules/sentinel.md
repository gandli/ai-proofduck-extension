## 2025-05-15 - Missing Content Security Policy (CSP)
**Vulnerability:** The browser extension lacked an explicit Content Security Policy (CSP) in `wxt.config.ts`. While Manifest V3 enforces a default CSP, explicit configuration is crucial for defense-in-depth, especially when dealing with WASM execution and external API connections. A missing CSP could allow unintended script execution or insecure connections if the default policy is too permissive or misinterpreted.
**Learning:** This project uses `@mlc-ai/web-llm` which requires `script-src 'wasm-unsafe-eval'` to function. Additionally, the extension allows users to configure custom API endpoints, necessitating `connect-src https:` (wildcard HTTPS) to support arbitrary secure origins while blocking insecure `http:` connections. Balancing these requirements with strict `script-src 'self'` is key.
**Prevention:** Always explicitly define `content_security_policy` in `manifest.json` or framework config. For ML/AI extensions using WASM, verify if `wasm-unsafe-eval` is required and scope it narrowly. For user-configurable endpoints, prefer `https:` over `*` to enforce encryption.
